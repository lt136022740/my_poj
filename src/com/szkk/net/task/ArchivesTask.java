package com.szkk.net.task;import org.json.JSONObject;import android.util.Log;import com.szkk.net.SZHttpRequest;import com.szkk.net.delegate.ArchivesTaskDelegate;import com.szkk.net.delegate.SZHttpRequestDelegate;import com.szkk.system.ApplicationManager;import com.szkk.system.AppConfig;public class ArchivesTask implements SZHttpRequestDelegate{	private ArchivesTaskDelegate delegate;	private String action;		public ArchivesTask(int archive_id, String action, ArchivesTaskDelegate delegate){		this.delegate = delegate;		this.action = action;		String url = "";		if(action.equals(ArchivesTaskDelegate.DEL)){			url = String.format("%sarchives/%d/delete", AppConfig.ROOT_URL, archive_id);		}else{			url = String.format("%sarchives/%d/get_diagnosis_result", AppConfig.ROOT_URL, 53);		}		SZHttpRequest request = new SZHttpRequest(this);		request.requestGet(url);	}  		@Override	public void requestSuccess(SZHttpRequest request) {		try {			String jsonStr = new String(request.receiveDataBuffer, "UTF-8");			JSONObject jsonObj = new JSONObject(jsonStr);			Log.i("tag1", jsonStr);			if(action.equals(ArchivesTaskDelegate.DEL)){				ApplicationManager.sharedManager().currentUser.updateWithJSON(jsonObj);				delegate.didFinishDeleteArchive();			}else{				delegate.didFinishGetDiagnosis(jsonObj.optString("diagnosis"));			}		} catch (Exception e) {		} 	}	@Override	public void requestFailed(int error) {		if(action.equals(ArchivesTaskDelegate.DEL)){			delegate.didFailedDeleteArchive();		}else{			delegate.didFailedGetDiagnosis();		}	}}