package com.szkk.net.task;import java.util.LinkedHashMap;import org.json.JSONObject;import com.szkk.data.User;import com.szkk.net.SZHttpRequest;import com.szkk.net.delegate.KKSearchTaskDelegate;import com.szkk.net.delegate.ModifyAccountTaskDelegate;import com.szkk.net.delegate.SZHttpRequestDelegate;import com.szkk.system.AppConfig;import com.szkk.system.ApplicationManager;public class KKSearchTask implements SZHttpRequestDelegate{	private KKSearchTaskDelegate delegate;		public KKSearchTask(String data, KKSearchTaskDelegate delegate){		this.delegate = delegate;		User user = ApplicationManager.sharedManager().currentUser;		String url = String.format("%susers/%d/update_user", AppConfig.ROOT_URL, user.getId());		LinkedHashMap<String, Object> params = new LinkedHashMap<String, Object>();		params.put("user_info", data);		SZHttpRequest request = new SZHttpRequest(this);		String body = request.makeBody(params);		request.requestPOST(url, body);	}		@Override	public void requestSuccess(SZHttpRequest request) {		try {			String jsonStr = new String(request.receiveDataBuffer, "UTF-8");			JSONObject jsonObj = new JSONObject(jsonStr);			ApplicationManager.sharedManager().currentUser.updateWithJSON(jsonObj);		} catch (Exception e) {					} 		delegate.didFinishSearch(null);	}	@Override	public void requestFailed(int error) {		delegate.didFailedSearch();	}}